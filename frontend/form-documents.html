
<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–î–æ–∫—É–º–µ–Ω—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–∞</title>
    <style>
      label {
        display: block;
        margin-top: 10px;
        margin-bottom: 10px;
        font-weight: bold;
      }
      input,
      select {
        width: 100%;
        padding: 10px 12px;
        margin-top: 4px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 6px;
        box-sizing: border-box;
        font-family: "Segoe UI", sans-serif;
        font-size: 14px;
      }
      .date-picker-wrapper input {
        padding: 10px 12px;
        background-image: url("data:image/svg+xml;utf8,<svg fill='%23004d99' height='20' viewBox='0 0 24 24' width='20' xmlns='http://www.w3.org/2000/svg'><path d='M19 4h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z'/></svg>");
        background-repeat: no-repeat;
        background-position: right 10px center;
        background-size: 20px 20px;
        appearance: none;
        -webkit-appearance: none;
        border-radius: 6px;
      }
      body {
        font-family: "Segoe UI", sans-serif;
        background: #f0f2f5;
        padding: 20px;
        font-size: 14px;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        min-height: 100vh;
      }
      .form-wrapper {
        max-width: 480px;
        background: #fff;
        padding: 20px;
        margin: 40px auto;
        border-radius: 6px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        width: 100%;
      }
      h2 {
        text-align: center;
        margin-bottom: 20px;
        font-size: 20px;
      }
      input[type="file"] {
        width: 100%;
        padding: 10px 12px;
        margin-top: 4px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 6px;
        box-sizing: border-box;
        font-family: "Segoe UI", sans-serif;
        font-size: 14px;
        height: auto;
      }
      .selfie-wrapper input[type="file"].field-error-input {
        border-color: red !important;
        box-shadow: 0 0 0 2px rgba(255, 0, 0, 0.2);
      }
      .selfie-wrapper.field-error-input {
        border: 1px solid red !important;
        border-radius: 6px;
        padding: 10px;
        box-sizing: border-box;
      }
      .btn {
        font-family: "Segoe UI", sans-serif;
        font-size: 14px;
        border: none;
        border-radius: 6px;
        padding: 10px;
        width: 100%;
        cursor: pointer;
        box-sizing: border-box;
      }
      .btn-primary {
        background-color: #004d99;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
        margin-top: 10px;
        padding: 10px;
      }
      .btn-reset {
        background-color: #ccc;
        color: #333;
        margin-top: 10px;
        padding: 10px;
        font-size: 14px;
        border-radius: 6px;
        border: none;
        cursor: pointer;
        width: 100%;
        box-sizing: border-box;
      }
      .btn-reset:hover {
        background-color: #bbb;
      }
      .arrow {
        font-weight: normal;
      }
      video,
      canvas {
        display: block;
        margin: 10px auto;
        max-width: 100%;
      }
      video {
        transform: scaleX(-1);
      }
      .field-error {
        color: red;
        font-size: 0.85em;
        margin-top: 4px;
      }
      .field-error-input {
        border-color: red !important;
        box-shadow: 0 0 0 2px rgba(255, 0, 0, 0.2);
      }
      @media (max-width: 480px) {
        label {
          font-size: 13px;
        }
        input,
        select,
        input[type="file"],
        .date-picker-wrapper input {
          font-size: 13px;
          padding: 10px 12px;
        }
      }
      .toast {
        position: fixed;
        background-color: #333;
        color: white;
        padding: 10px 16px;
        border-radius: 6px;
        font-size: 14px;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.5s ease, transform 0.5s ease;
        z-index: 9999;
      }
      .toast.show {
        opacity: 1;
        pointer-events: auto;
      }
      @media (min-width: 481px) {
        .toast {
          bottom: 20px;
          right: 20px;
          transform: translateY(20px);
        }
        .toast.show {
          transform: translateY(0);
        }
      }

      .gender-selection {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        margin-top: 4px;
      }
      .gender-card {
        flex: 1;
        background-color: #fff;
        border: 2px solid #ccc;
        border-radius: 6px;
        padding: 10px;
        text-align: center;
        cursor: pointer;
        font-weight: bold;
        transition: border-color 0.3s, background-color 0.3s, color 0.3s;
      }
      .gender-card input[type="radio"] {
        display: none;
      }
      .gender-card:hover {
        border-color: #004d99;
      }
      .gender-card.selected {
        border-color: #004d99;
        background-color: #004d99;
        color: white;
      }

#uploadOverlay {
  position: fixed;
  top: 0; left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(255, 255, 255, 0.85);
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  font-size: 16px;
  font-family: "Segoe UI", sans-serif;
}
.loader {
  border: 6px solid #ccc;
  border-top: 6px solid #004d99;
  border-radius: 50%;
  width: 48px;
  height: 48px;
  animation: spin 1s linear infinite;
  margin-bottom: 12px;
}
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
    </style>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>
  </head>
  <body>
    <div id="toast" class="toast">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</div>
    <div class="form-wrapper">
      <h2>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å—Ç—É–¥–µ–Ω—Ç–∞</h2>
      <form id="documentForm" novalidate>
        <label
          >–£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ (—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –∏–ª–∏ —Å–∫–∞–Ω-–∫–æ–ø–∏—è):
          <input type="file" id="idCard" accept="image/*,application/pdf" />
          <img
            id="idCardPreview"
            alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è"
            style="display: none; max-height: 150px; margin-top: 10px"
          />
        </label>

        <label
          >–°–ø—Ä–∞–≤–∫–∞ —Å –º–µ—Å—Ç–∞ —É—á—ë–±—ã:
          <input
            type="file"
            id="universityProof"
            accept="image/*,application/pdf"
          />
          <img
            id="universityProofPreview"
            alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ø—Ä–∞–≤–∫–∏"
            style="display: none; max-height: 150px; margin-top: 10px"
          />
        </label>

        <label>
          –°–Ω–∏–º–æ–∫ —Ñ–ª—é—Ä–æ–≥—Ä–∞—Ñ–∏–∏:
          <input type="file" id="fluorographyScan" accept="image/*,application/pdf" />
          <img
            id="fluorographyPreview"
            alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–ª—é–æ—Ä–æ–≥—Ä–∞—Ñ–∏–∏"
            style="display: none; max-height: 150px; margin-top: 10px"
          />
        </label>

        <label>
          –°–Ω–∏–º–æ–∫ –∫–∞–º–µ—Ä—ã (—Å–µ–ª—Ñ–∏):
          <input type="file" id="selfieUpload" accept="image/*" />
          <img
            id="selfiePreview"
            alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–µ–ª—Ñ–∏"
            style="display: none; max-height: 150px; margin-top: 10px"
          />
        </label>

        <div style="margin-top: 20px">
          <h2 style="text-align: center; margin-bottom: 20px; font-size: 20px">
            –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
          </h2>

          <label for="email">Email:</label>
          <input type="email" id="email" name="email" placeholder="example@mail.com" required />

          <label for="registrationCity">–ì–æ—Ä–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</label>
          <input type="text" id="registrationCity" name="registrationCity" placeholder="–ê—Å—Ç–∞–Ω–∞" required />

          <label for="registrationAddress">–ê–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (—É–ª–∏—Ü–∞, –¥–æ–º, –∫–≤):</label>
          <input type="text" id="registrationAddress" name="registrationAddress" placeholder="—É–ª. –ú–∏—Ä–∞, –¥. 30, –∫–≤. 15" required />

          <label
            >–ù–æ–º–µ—Ä —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏:
            <input
              type="text"
              id="documentNumber"
              inputmode="numeric"
              pattern="\d*"
            />
          </label>

          <label>–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞:</label>
          <div class="date-picker-wrapper">
            <input
              type="text"
              id="documentIssueDate"
              placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É"
            />
          </div>

          <label
            >–û—Ä–≥–∞–Ω, –≤—ã–¥–∞–≤—à–∏–π –¥–æ–∫—É–º–µ–Ω—Ç:
            <input type="text" id="documentIssuer" placeholder="“ö–† –Ü–®–ö–Ü –Ü–°–¢–ï–† –ú–ò–ù–ò–°–¢–†–õ–Ü–ì–Ü"/>
          </label>

          <label>–Ø–≤–ª—è–µ—Ç–µ—Å—å –ª–∏ –í—ã –º–∞–≥–∏—Å—Ç—Ä–∞–Ω—Ç–æ–º?</label>
          <div class="gender-selection">
            <label class="gender-card">
              <input type="radio" name="isGraduate" value="–î–∞" />
              –î–∞
            </label>
            <label class="gender-card">
              <input type="radio" name="isGraduate" value="–ù–µ—Ç" />
              –ù–µ—Ç
            </label>
          </div>

          <label>–ù–∞–ª–∏—á–∏–µ –∏–Ω–≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏:</label>
          <div class="gender-selection">
            <label class="gender-card">
              <input type="radio" name="hasDisability" value="–ï—Å—Ç—å" />
              –ï—Å—Ç—å
            </label>
            <label class="gender-card">
              <input type="radio" name="hasDisability" value="–ù–µ—Ç—É" />
              –ù–µ—Ç—É
            </label>
          </div>
        </div>

        <button type="button" class="btn btn-reset" id="resetButton">
          <span class="btn-label">–°–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</span>
          <span class="arrow">&#128465;</span>
        </button>

        <div
          style="
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            gap: 10px;
            margin-top: 20px;
          "
        >
          <button type="button" class="btn btn-primary" id="backButton">
            <span class="arrow">&#8592;</span>
            <span class="btn-label">–ù–∞–∑–∞–¥</span>
          </button>

          <button type="submit" class="btn btn-primary" id="nextButton">
            <span class="btn-label">–î–∞–ª–µ–µ</span>
            <span class="arrow">&#8594;</span>
          </button>
        </div>
      </form>
    </div>

    <script>
      const form = document.getElementById("documentForm");
      function dataURLtoBlob(dataurl) {
        const arr = dataurl.split(',');
        const mime = arr[0].match(/:(.*?);/)[1];
        const bstr = atob(arr[1]);
        let n = bstr.length;
        const u8arr = new Uint8Array(n);
        while (n--) {
          u8arr[n] = bstr.charCodeAt(n);
        }
        return new Blob([u8arr], { type: mime });
      }
      const idCardInput = document.getElementById("idCard");
      const fluorographyInput = document.getElementById("fluorographyScan");
      const fluorographyPreview = document.getElementById("fluorographyPreview");
      const selfieInput = document.getElementById("selfieUpload");
      const selfiePreview = document.getElementById("selfiePreview");
      // –ü—Ä–µ–≤—å—é –¥–ª—è fluorography
      fluorographyInput.addEventListener("change", () => {
        previewFile(fluorographyInput, fluorographyPreview);
      });
      selfieInput.addEventListener("change", () => {
        previewFile(selfieInput, selfiePreview);
      });
      const universityProofInput = document.getElementById("universityProof");
      const idCardPreview = document.getElementById("idCardPreview");
      const universityProofPreview = document.getElementById(
        "universityProofPreview"
      );
      const documentNumberInput = document.getElementById("documentNumber");
      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –æ—Ç –Ω–µ—Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
      documentNumberInput.addEventListener("input", () => {
        documentNumberInput.value = documentNumberInput.value.replace(
          /\D/g,
          ""
        );
      });
      const documentIssueDateInput =
        document.getElementById("documentIssueDate");
      const documentIssuerInput = document.getElementById("documentIssuer");
      const resetButton = document.getElementById("resetButton");
      const backButton = document.getElementById("backButton");
      const nextButton = document.getElementById("nextButton");


      // –ü—Ä–µ–≤—å—é –¥–ª—è idCard
      idCardInput.addEventListener("change", () => {
        previewFile(idCardInput, idCardPreview);
      });

      // –ü—Ä–µ–≤—å—é –¥–ª—è universityProof
      universityProofInput.addEventListener("change", () => {
        previewFile(universityProofInput, universityProofPreview);
      });

      // –ü—Ä–µ–≤—å—é –¥–ª—è selfieUpload (–º–æ–±–∏–ª—å–Ω–æ–µ)
      // (canvas –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –ø—Ä–µ–≤—å—é –Ω–µ –¥–µ–ª–∞–µ–º)

      function previewFile(inputElement, previewImg) {
        if (inputElement.files && inputElement.files[0]) {
          const file = inputElement.files[0];
          if (file.type.startsWith("image/")) {
            const reader = new FileReader();
            reader.onload = function (e) {
              previewImg.src = e.target.result;
              previewImg.style.display = "block";
            };
            reader.readAsDataURL(file);
          } else {
            previewImg.src = "";
            previewImg.style.display = "none";
          }
        } else {
          previewImg.src = "";
          previewImg.style.display = "none";
        }
      }


      // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã –∏ –æ—á–∏—Å—Ç–∫–∞ localStorage, preview, canvas –∏ –æ—à–∏–±–æ–∫
      resetButton.onclick = function () {
        form.reset();
        localStorage.removeItem("studentDocuments");
        idCardPreview.src = "";
        idCardPreview.style.display = "none";
        universityProofPreview.src = "";
        universityProofPreview.style.display = "none";
        fluorographyPreview.src = "";
        fluorographyPreview.style.display = "none";
        document.querySelectorAll(".field-error").forEach((e) => e.remove());
        document.querySelectorAll(".field-error-input").forEach((el) => {
          el.classList.remove("field-error-input");
          el.style.border = "";
        });
        // –£–±—Ä–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏—è radio-–∫–Ω–æ–ø–æ–∫ –∏ –æ—à–∏–±–∫–∏
        document
          .querySelectorAll(".gender-card")
          .forEach((card) => card.classList.remove("selected"));
        document
          .querySelectorAll(".gender-selection + .field-error")
          .forEach((err) => err.remove());
        // –°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä radio-–∫–Ω–æ–ø–æ–∫
        document
          .querySelectorAll('input[type="radio"]')
          .forEach((r) => (r.checked = false));
        // (end radio reset)
      };

      // captureSelfie –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

      // –§—É–Ω–∫—Ü–∏—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã (–±–µ–∑ idCardPreview, universityProofPreview, selfieUploaded)
      function collectFormData() {
        return new Promise((resolve) => {
          resolve({
            email: document.getElementById("email").value.trim(),
            registrationCity: document.getElementById("registrationCity").value.trim(),
            registrationAddress: document.getElementById("registrationAddress").value.trim(),
            documentNumber: documentNumberInput.value.trim(),
            documentIssueDate: documentIssueDateInput.value.trim(),
            documentIssuer: documentIssuerInput.value.trim(),
            isGraduate:
              document.querySelector('input[name="isGraduate"]:checked')?.value ||
              "",
            hasDisability:
              document.querySelector('input[name="hasDisability"]:checked')
                ?.value || "",
          });
        });
      }

      // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–∞ –≤ base64
      function fileToBase64(file) {
        return new Promise((resolve) => {
          if (!file) {
            resolve(null);
            return;
          }
          const reader = new FileReader();
          reader.onload = function (e) {
            resolve(e.target.result);
          };
          reader.onerror = function () {
            resolve(null);
          };
          reader.readAsDataURL(file);
        });
      }

      // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
      function saveToLocalStorage(data) {
        const capitalize = (str) =>
          str
            .trim()
            .split(/\s+/)
            .map((w) => w.charAt(0).toUpperCase() + w.slice(1).toLowerCase())
            .join(" ");

        const city = data.registrationCity.trim().replace(/^–≥\.\s*/i, "");
        const formattedCity = "–≥." + capitalize(city);

        const minimalData = {
          email: data.email,
          registrationCity: formattedCity,
          registrationAddress: data.registrationAddress.trim(),
          documentNumber: data.documentNumber,
          documentIssueDate: data.documentIssueDate,
          documentIssuer: data.documentIssuer.trim(),
          isGraduate: data.isGraduate,
          hasDisability: data.hasDisability,
        };
        localStorage.setItem("studentDocuments", JSON.stringify(minimalData));
      }

      // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      window.onload = function () {
        const savedData = localStorage.getItem("studentDocuments");
        let data = null;
        if (savedData) {
          try {
            data = JSON.parse(savedData);
          } catch {
            data = null;
          }
        }
        if (data) {
          if (data.email) document.getElementById("email").value = data.email;
          if (data.registrationCity) document.getElementById("registrationCity").value = data.registrationCity;
          if (data.registrationAddress) document.getElementById("registrationAddress").value = data.registrationAddress;
          if (data.documentNumber)
            documentNumberInput.value = data.documentNumber;
          if (data.documentIssueDate)
            documentIssueDateInput.value = data.documentIssueDate;
          if (data.documentIssuer)
            documentIssuerInput.value = data.documentIssuer;
          if (data.isGraduate) {
            const input = document.querySelector(
              `input[name="isGraduate"][value="${data.isGraduate}"]`
            );
            if (input) {
              input.checked = true;
              input.parentElement.classList.add("selected");
            }
          }
          if (data.hasDisability) {
            const input = document.querySelector(
              `input[name="hasDisability"][value="${data.hasDisability}"]`
            );
            if (input) {
              input.checked = true;
              input.parentElement.classList.add("selected");
            }
          }
        }
        // –ù–µ—Ç –≤—Å—Ç–∞–≤–∫–∏ –ø—Ä–µ–≤—å—é –∏ —Å–µ–ª—Ñ–∏
        // clearCanvas(); // —É–¥–∞–ª–µ–Ω–æ
        // flatpickr –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ–≥–¥–∞, —Ç–æ–ª—å–∫–æ –≤—ã–±–æ—Ä –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        flatpickr("#documentIssueDate", {
          dateFormat: "Y-m-d",
          locale: flatpickr.l10ns.ru,
          allowInput: false, // –æ—Ç–∫–ª—é—á–∞–µ–º —Ä—É—á–Ω–æ–π –≤–≤–æ–¥
          defaultDate: data?.documentIssueDate || null,
          onChange: function (selectedDates, dateStr) {
            documentIssueDateInput.value = dateStr;
          }
        });
      };

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
      backButton.onclick = function () {
        collectFormData().then((data) => {
          saveToLocalStorage(data); // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–∂–µ –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
          window.location.href = "form-personal.html";
        });
      };

      // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ—à–∏–±–∫–∏ —Å–µ–ª—Ñ–∏ (–æ–¥–∏–Ω —Ä–∞–∑)
      let selfieErrorContainerEl = null;
      function getSelfieErrorContainer() {
        const selfieUpload = document.getElementById("selfieUpload");

        if (selfieErrorContainerEl && selfieErrorContainerEl.parentNode)
          return selfieErrorContainerEl;

        selfieErrorContainerEl = document.createElement("div");
        selfieErrorContainerEl.className = "selfie-error-container";

        selfieUpload.insertAdjacentElement("afterend", selfieErrorContainerEl);

        return selfieErrorContainerEl;
      }

      // --- –û–ø—Ä–µ–¥–µ–ª—è–µ–º selfieUpload —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤—Å–µ—Ö innerHTML ---
      const selfieUpload = document.getElementById("selfieUpload");

      form.onsubmit = function (e) {
        e.preventDefault();

        let hasErrors = false;

        removeError(documentNumberInput);
        removeError(documentIssueDateInput);
        removeError(documentIssuerInput);

        // Remove previous errors for file inputs
        removeError(idCardInput);
        removeError(universityProofInput);

        // Remove previous errors for radio groups
        const isGraduateInput = document.querySelector(
          'input[name="isGraduate"]:checked'
        );
        const hasDisabilityInput = document.querySelector(
          'input[name="hasDisability"]:checked'
        );

        // Remove previous errors
        document
          .querySelectorAll('input[name="isGraduate"]')
          .forEach((el) => removeError(el));
        document
          .querySelectorAll('input[name="hasDisability"]')
          .forEach((el) => removeError(el));

        // –£–¥–∞–ª—è–µ–º –æ—à–∏–±–∫—É —Å–µ–ª—Ñ–∏
        const selfieErrorContainer = getSelfieErrorContainer();
        removeError(selfieErrorContainer);

        // –ù–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è email, registrationCity, registrationAddress
        const emailInput = document.getElementById("email");
        const registrationCityInput = document.getElementById("registrationCity");
        const registrationAddressInput = document.getElementById("registrationAddress");

        removeError(emailInput);
        removeError(registrationCityInput);
        removeError(registrationAddressInput);

        const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailPattern.test(emailInput.value.trim())) {
          showError(emailInput, "–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email");
          hasErrors = true;
        }
        if (!registrationCityInput.value.trim()) {
          showError(registrationCityInput, "–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏");
          hasErrors = true;
        }
        if (!registrationAddressInput.value.trim()) {
          showError(registrationAddressInput, "–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏");
          hasErrors = true;
        }

        // Validate document number (–º—è–≥–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã)
        if (!/^\d+$/.test(documentNumberInput.value.trim())) {
          showError(documentNumberInput, "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è");
          hasErrors = true;
        }
        // Validate issue date (—Ç–æ–ª—å–∫–æ –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å)
        if (!documentIssueDateInput.value.trim()) {
          showError(documentIssueDateInput, "–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –≤—ã–¥–∞—á–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞");
          hasErrors = true;
        }
        // Validate issuer (—Ç–æ–ª—å–∫–æ –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å)
        if (!documentIssuerInput.value.trim()) {
          showError(documentIssuerInput, "–í–≤–µ–¥–∏—Ç–µ, –∫–µ–º –≤—ã–¥–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç");
          hasErrors = true;
        }

        // --- LOG FILES BEFORE FILE VALIDATION ---
        console.log("üìÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π:");
        console.log("ü™™ –£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏:", idCardInput?.files?.[0]);
        console.log("üè´ –°–ø—Ä–∞–≤–∫–∞ —Å –º–µ—Å—Ç–∞ —É—á—ë–±—ã:", universityProofInput?.files?.[0]);
        console.log("ü©ª –°–Ω–∏–º–æ–∫ —Ñ–ª—é—Ä–æ–≥—Ä–∞—Ñ–∏–∏:", fluorographyInput?.files?.[0]);
        console.log("üì∏ –°–µ–ª—Ñ–∏:", selfieUpload?.files?.[0]);


        // Validate radio buttons
        if (!isGraduateInput) {
          showError(
            document.querySelector('input[name="isGraduate"]'),
            "–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è '–ú–∞–≥–∏—Å—Ç—Ä–∞–Ω—Ç'"
          );
          hasErrors = true;
        }
        if (!hasDisabilityInput) {
          showError(
            document.querySelector('input[name="hasDisability"]'),
            "–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è '–ò–Ω–≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å'"
          );
          hasErrors = true;
        }

        // --- –î–û–ë–ê–í–õ–ï–ù–ê –í–ê–õ–ò–î–ê–¶–ò–Ø –§–ê–ô–õ–û–í ---
        // 1. fluorographyInput
        if (!fluorographyInput.files.length) {
          showError(fluorographyInput, "–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–Ω–∏–º–æ–∫ —Ñ–ª—é–æ—Ä–æ–≥—Ä–∞—Ñ–∏–∏");
          hasErrors = true;
        }
        // 2. selfieUpload (—Å–µ–ª—Ñ–∏)
        if (!selfieUpload.files.length) {
          showError(getSelfieErrorContainer(), "–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–µ–ª—Ñ–∏");
          hasErrors = true;
        }
        // 3. idCardInput
        if (!idCardInput.files.length) {
          showError(idCardInput, "–ó–∞–≥—Ä—É–∑–∏—Ç–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏");
          hasErrors = true;
        }
        // 4. universityProofInput
        if (!universityProofInput.files.length) {
          showError(universityProofInput, "–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–ø—Ä–∞–≤–∫—É —Å –º–µ—Å—Ç–∞ —É—á—ë–±—ã");
          hasErrors = true;
        }

        if (hasErrors) {
          showToast("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –≤ —Ñ–æ—Ä–º–µ");
          return;
        } else {
          // –µ—Å–ª–∏ –æ—à–∏–±–æ–∫ –Ω–µ—Ç ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ localStorage
          const documentData = {
            email: emailInput.value.trim(),
            registrationCity: registrationCityInput.value.trim(),
            registrationAddress: registrationAddressInput.value.trim(),
            documentNumber: documentNumberInput.value.trim(),
            documentIssueDate: documentIssueDateInput.value.trim(),
            documentIssuer: documentIssuerInput.value.trim(),
            isGraduate: isGraduateInput?.value || "",
            hasDisability: hasDisabilityInput?.value || ""
          };
          // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ registrationCity –∏ registrationAddress
          saveToLocalStorage({
            ...documentData,
            registrationCity: registrationCityInput.value.trim(),
            registrationAddress: registrationAddressInput.value.trim()
          });
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã form-personal.html
        const personalDataRaw = localStorage.getItem("studentFormData");
        console.log("Raw data:", personalDataRaw);
        if (!personalDataRaw) {
          alert(
            "–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Ñ–æ—Ä–º—É."
          );
          window.location.href = "form-personal.html";
          return;
        }

        let personalData;
        try {
          personalData = JSON.parse(personalDataRaw);
          console.log("Parsed data:", personalData);
        } catch (e) {
          alert("–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤–≤–æ–¥.");
          window.location.href = "form-personal.html";
          return;
        }

        if (
          !personalData.firstName ||
          !personalData.lastName ||
          !personalData.phone ||
          personalData.firstName.trim() === "" ||
          personalData.lastName.trim() === "" ||
          personalData.phone.trim() === ""
        ) {
          alert(
            "–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é."
          );
          window.location.href = "form-personal.html";
          return;
        }

        // --- Overlay show and disable nextButton ---
        document.getElementById("uploadOverlay").style.display = "flex";
        nextButton.disabled = true;

        collectFormData().then((documentData) => {
          // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–µ –∏–º—è/—Ñ–∞–º–∏–ª–∏—é
          if (!personalData.firstName || !personalData.lastName) {
            alert("‚ùå –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É —Å –ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.");
            return;
          }
          // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç—ã–µ —Ñ–∞–π–ª—ã
          if (
            !idCardInput.files[0] ||
            !universityProofInput.files[0] ||
            !fluorographyInput.files[0] ||
            !selfieUpload.files[0]
          ) {
            alert("‚ùå –û–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤—Å–µ 4 –¥–æ–∫—É–º–µ–Ω—Ç–∞.");
            return;
          }
          const formData = new FormData();
          // –î–æ–±–∞–≤–ª—è–µ–º –§–ò–û –∏–∑ personalData
          formData.append("firstName", personalData.firstName);
          formData.append("lastName", personalData.lastName);
          formData.append("middleName", personalData.middleName || "");
          formData.append("idCard", idCardInput.files[0]);
          formData.append("universityProof", universityProofInput.files[0]);
          formData.append("fluorography", fluorographyInput.files[0]);
          // –§–æ—Ä–º–∏—Ä—É–µ–º selfieBlob –∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤ formData
          if (selfieUpload.files.length) {
            const selfieFile = selfieUpload.files[0];
            console.log("üì§ SELFIE FILE:", selfieFile);
            console.log("üì§ SELFIE name:", selfieFile.name);
            console.log("üì§ SELFIE size:", selfieFile.size);
            console.log("üì§ SELFIE type:", selfieFile.type);
            formData.append("selfie", selfieFile);
            showToast("‚úÖ –°–µ–ª—Ñ–∏ –≤—ã–±—Ä–∞–Ω–æ: " + selfieFile.name);
          } else {
            console.warn("‚ùå –°–µ–ª—Ñ–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ –∏–ª–∏ –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è");
            alert("‚ùå –°–µ–ª—Ñ–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ –∏–ª–∏ –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ.");
          }

          formData.append("documentNumber", documentNumberInput.value.trim());
          formData.append("documentIssueDate", documentIssueDateInput.value.trim());
          formData.append("documentIssuer", documentIssuerInput.value.trim());
          formData.append("isGraduate", isGraduateInput.value);
          formData.append("hasDisability", hasDisabilityInput.value);

          // --- –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—è –∏–∑ form-personal.html –∏ form-documents.html ---
          formData.append("iin", personalData.iin || "");
          formData.append("phone", personalData.phone || "");
          formData.append("email", documentData.email || "");
          formData.append("university", personalData.university || "");
          formData.append("registrationAddress", documentData.registrationAddress || "");
          formData.append("room", personalData.room || "");
          formData.append("block", personalData.block || "");

          // –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
          console.log("üì§ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä...");
          const baseURL = location.origin;
          console.log("üåê fetch URL:", baseURL + "/api/upload");
          fetch(baseURL + "/api/upload", {
            method: "POST",
            body: formData,
          })
            .then((response) => {
              document.getElementById("uploadOverlay").style.display = "none";
              nextButton.disabled = false;
              if (!response.ok) throw new Error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ");
              return response.json();
            })
            .then((data) => {
              document.getElementById("uploadOverlay").style.display = "none";
              nextButton.disabled = false;
              if (data.success) {
                showToast("–î–æ–∫—É–º–µ–Ω—Ç—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã");
                window.location.href = "pick-room.html";
              } else {
                showToast(data.message || "–û—à–∏–±–∫–∞: –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–µ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é");
              }
            })
            .catch(async (error) => {
              document.getElementById("uploadOverlay").style.display = "none";
              nextButton.disabled = false;
              console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:", error);
              if (error.response) {
                const errorText = await error.response.text();
                console.error("üìÑ –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:", errorText);
              }
              alert("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: " + error.message);
              showToast("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: " + error.message);
            });
        });
      };

      // –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
      function showToast(message) {
        const toast = document.getElementById("toast");
        toast.textContent = message;
        toast.classList.remove("show");
        void toast.offsetWidth;
        toast.classList.add("show");
        clearTimeout(toast.hideTimeout);
        toast.hideTimeout = setTimeout(() => {
          toast.classList.remove("show");
        }, 3000);
      }

      // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π
      function showError(el, message) {
        removeError(el);
        const error = document.createElement("div");
        // –ï—Å–ª–∏ —ç—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–µ–ª—Ñ–∏-–æ—à–∏–±–∫–∏, –ø—Ä–æ—Å—Ç–æ append, –Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç —É–∂–µ field-error
        if (
          el.classList && el.classList.contains("selfie-error-container") &&
          el.querySelector(".field-error")
        ) return;
        if (el.classList && el.classList.contains("selfie-error-container")) {
          error.className = "field-error";
          error.innerHTML = "<b>" + message + "</b>";
          el.appendChild(error);
          const selfieInput = document.getElementById("selfieUpload");
          selfieInput.classList.add("field-error-input");
          // –£–¥–∞–ª—è–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ –Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—è, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –¥–≤–æ–π–Ω–æ–π —Ä–∞–º–∫–∏
          //selfieInput.parentElement?.classList.add("field-error-input");
          selfieInput.style.border = "";
        } else if (el.type === "radio") {
          const group = document.querySelectorAll(`input[name="${el.name}"]`);
          const groupWrapper = group[0].closest(".gender-selection");
          group.forEach((input) => {
            input.classList.add("field-error-input");
            // –£–¥–∞–ª—è–µ–º –ø—Ä—è–º–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ border, —Ç–æ–ª—å–∫–æ –∫–ª–∞—Å—Å
            if (input.parentElement) {
              input.parentElement.classList.add("field-error-input");
              input.parentElement.style.border = ""; // remove direct style
            }
          });
          if (
            groupWrapper &&
            !groupWrapper.nextElementSibling?.classList.contains("field-error")
          ) {
            const error = document.createElement("div");
            error.className = "field-error";
            error.textContent = message;
            groupWrapper.insertAdjacentElement("afterend", error);
          }
        } else {
          if (el.type === "file") {
            error.className = "field-error";
            error.innerHTML = "<b>" + message + "</b>";
            const parentLabel = el.closest("label");
            if (parentLabel && !parentLabel.querySelector(".field-error")) {
              parentLabel.insertAdjacentElement("beforeend", error);
            } else if (!parentLabel) {
              el.insertAdjacentElement("afterend", error);
            }
          } else {
            error.className = "field-error";
            error.textContent = message;
            el.insertAdjacentElement("afterend", error);
          }
          el.classList.add("field-error-input");
          el.style.border = ""; // remove direct style
        }
      }

      function removeError(el) {
        // –ï—Å–ª–∏ —ç—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–µ–ª—Ñ–∏-–æ—à–∏–±–∫–∏, —É–¥–∞–ª—è–µ–º –≤—Å–µ field-error –≤–Ω—É—Ç—Ä–∏
        if (el.classList && el.classList.contains("selfie-error-container")) {
          Array.from(el.querySelectorAll(".field-error")).forEach((e) =>
            e.remove()
          );
          const selfieInput = document.getElementById("selfieUpload");
          selfieInput.classList.remove("field-error-input");
          selfieInput.parentElement?.classList.remove("field-error-input");
          selfieInput.parentElement?.classList.remove("field-error-input");
          selfieInput.style.border = "";
        } else if (el.type === "radio") {
          const group = document.querySelectorAll(`input[name="${el.name}"]`);
          group.forEach((input) => {
            input.classList.remove("field-error-input");
            if (input.parentElement) {
              input.parentElement.classList.remove("field-error-input");
              input.parentElement.style.border = "";
            }
          });
          // –¢–∞–∫–∂–µ —É–¥–∞–ª–∏–º –æ—à–∏–±–∫—É –ø–æ—Å–ª–µ .gender-selection
          const groupWrapper = el.closest(".gender-selection");
          const next = groupWrapper?.nextElementSibling;
          if (next && next.classList.contains("field-error")) {
            next.remove();
          }
        } else {
          const next = el.nextElementSibling;
          if (next && next.classList.contains("field-error")) {
            next.remove();
          }
          el.classList.remove("field-error-input");
          el.style.border = "";
        }
      }

      function validateOnBlur(el, message, pattern = null) {
        el.addEventListener("blur", () => {
          removeError(el);
          if (!el.value.trim()) {
            showError(el, message);
          } else if (pattern && !pattern.test(el.value.trim())) {
            showError(el, message);
          }
        });
      }

      // –ú—è–≥–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–∞ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è –Ω–∞ blur:
      validateOnBlur(
        documentNumberInput,
        "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è",
        /^\d+$/
      );
      validateOnBlur(
        documentIssueDateInput,
        "–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –≤—ã–¥–∞—á–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞"
      );
      validateOnBlur(
        documentIssuerInput,
        "–í–≤–µ–¥–∏—Ç–µ, –∫–µ–º –≤—ã–¥–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç"
      );
      // –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ blur –¥–ª—è email, registrationCity, registrationAddress
      validateOnBlur(document.getElementById("email"), "–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email", /^[^\s@]+@[^\s@]+\.[^\s@]+$/);
      validateOnBlur(document.getElementById("registrationCity"), "–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏");
      validateOnBlur(document.getElementById("registrationAddress"), "–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏");

      // –ê–∫—Ç–∏–≤–∞—Ü–∏—è .selected —É –≤—ã–±—Ä–∞–Ω–Ω–æ–π radio-–∫–Ω–æ–ø–∫–∏
      document
        .querySelectorAll('.gender-card input[type="radio"]')
        .forEach((radio) => {
          radio.addEventListener("change", () => {
            const group = radio.closest(".gender-selection");
            if (group) {
              group
                .querySelectorAll(".gender-card")
                .forEach((card) => card.classList.remove("selected"));
            }
            radio.parentElement.classList.add("selected");
            removeError(radio); // —É–¥–∞–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ
          });
        });

      // --- ROOM SELECTION PATCH (visual increment on pick-room) ---
      // This code should be added in pick-room.html, not here.
      // Example for reference:
      // div.addEventListener("click", () => {
      //   room.occupied++;
      //   div.querySelector("div:nth-child(2)").textContent = `${room.occupied}/${room.places}`;
      //   div.classList.add("selected");
      //   localStorage.setItem("selectedRoom", JSON.stringify(room));
      // });
    </script>
    <div id="uploadOverlay" style="display: none;">
      <div class="loader"></div>
      <div class="message">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤...</div>
    </div>
  </body>
</html>
